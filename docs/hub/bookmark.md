书签功能设计
=========

鬼门关的书签页面设计为，当注册/登录成功后，重定向到书签页面，并携带用户名和密码信息，书签页面提示：保存当前页面为书签可自动登录账号。

---

### 实现逻辑

1. 当注册成功后，根据书签模板加上用户名和密码，构建重定向路径，到第三步
2. 当登录成功后，在自定义的认证成功处理器中，根据书签模板加上用户名和密码，构建重定向路径，到第三步
3. 有一个特殊请求转换器，用来做不同于账号密码的登录情况
   1. 检测到请求参数包含用户名和密码
      1. 如果与当前登录的用户名相同，则不做任何处理，到第四步（登录成功的情况）
      2. 如果与当前登录的用户名不同，则转换为认证 Token 用于后续的认证操作（书签访问或注册成功的情况），同时通过自定义的过滤器进行登录操作后，到第四步
4. 到 /stage/bookmark?username=&password=&time= 页面，我们显示相关信息并提示可以保存为书签

### 未来优化

1. 参考 basic 认证，将用户名和密码用 base64 编码，随后作为 code 参数重定向到书签路径进行解析
2. 参考 token 认证，用 UUID 或 username + random 方式生成 token 保存到 account 表中，一对多存储，并作为参数重定向到书签路径进行解析
3. 参考 auth2.0 认证，用 jwt 方式编码生成 token，不需要进行存储，即可作为参数重定向到书签路径进行解析
4. 建立 session 表用于保存游戏会话， jwt 则包含会话 id 和其他信息，两者搭配可以很好的解决一些安全隐患，但同时带来了编码的复杂性，需要权衡一下